(function($){"use strict";var TransitionGroup=React.addons.CSSTransitionGroup,LoginBox=React.createClass({displayName:"LoginBox",getInitialState:function(){return{autoLogin:!0}},componentDidMount:function(){$("#login-box .family").focus()},handleLogin:function(e){alert("ログイン処理：未実装..."),e.preventDefault()},handleSignIn:function(e){alert("サインイン処理：未実装..."),e.preventDefault()},handleAutoLoginChange:function(){this.setState({autoLogin:!this.state.autoLogin})},render:function(){return React.createElement("fieldset",null,React.createElement("legend",null,"家族と使う"),React.createElement("div",{className:"form-group"},React.createElement("input",{type:"text",className:"form-control family",ref:"family",placeholder:"ファミリー"})),React.createElement("div",{className:"form-group"},React.createElement("input",{type:"password",className:"form-control password",ref:"password",placeholder:"合言葉"})),React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",name:"autoLogin",checked:this.state.autoLogin,onChange:this.handleAutoLoginChange}),"ログインしたままにする")),React.createElement("a",{className:"login-text",href:"#",onClick:this.handleLogin},"ログイン"),"または",React.createElement("a",{className:"btn btn-success",onClick:this.handleSignIn},React.createElement("i",{className:"glyphicon glyphicon-ok-sign"}),"サインアップ"))}}),GuestMenu=React.createClass({displayName:"GuestMenu",getInitialState:function(){return{active:!1,data:[{itemName:"word-search",iconName:"search",itemText:"ワード検索"},{itemName:"genre",iconName:"tags",itemText:"ジャンル別"},{itemName:"neighbor",iconName:"home",itemText:"おとなり"},{itemName:"menu-registration",iconName:"plus",itemText:"メニュー追加"}]}},handleItemClick:function(e){this.props.onActiveChange({active:!0}),this.setState({active:!0,activeMenuName:e.itemName})},render:function(){var self=this,items=this.state.data.map(function(data){return React.createElement(MenuItem,{key:data.itemName,itemName:data.itemName,iconName:data.iconName,itemText:data.itemText,onClick:self.handleItemClick})});return React.createElement("div",{id:"guest-menu"},React.createElement(TransitionGroup,{transitionName:"top-box"},this.state.active?null:React.createElement("h2",{className:"title-single"},"一人で使う")),React.createElement("div",{className:"menu-items"},items),this.state.active?React.createElement("div",{className:"contents"},React.createElement(WordSearch,{visible:"word-search"===this.state.activeMenuName}),React.createElement(Genre,{visible:"genre"===this.state.activeMenuName}),React.createElement(Neighbor,{visible:"neighbor"===this.state.activeMenuName}),React.createElement(MenuRegistration,{visible:"menu-registration"===this.state.activeMenuName})):null)}}),MenuItem=React.createClass({displayName:"MenuItem",handleClick:function(e){var itemTag=$(e.target).parent(".menu-item");this.props.onClick({itemTag:itemTag[0],itemName:this.props.itemName})},render:function(){return React.createElement("div",{className:"menu-item "+this.props.itemName,onClick:this.handleClick},React.createElement("i",{className:"glyphicon glyphicon-"+this.props.iconName}),this.props.itemText)}}),Indicator=React.createClass({displayName:"Indicator",componentDidUpdate:function(){var indicator=$(React.findDOMNode(this.refs.indicator));if(!this.props.active)return indicator.activity(!1).hide(),void 0;var button=$(React.findDOMNode(this.props.buttonRef));indicator.height(button.outerHeight()),indicator.width(button.outerWidth()),indicator.css(button.position()),indicator.show().activity()},handle:function(e){console.log("handle"),e.stopPropagation()},componentDidMount:function(){$(document).on("click",function(e){console.log(e)})},render:function(){return React.createElement("span",{className:"Indicator",ref:"indicator",onClick:this.handle,style:{position:"absolute",zIndex:"900",cursor:"default"}})}}),WordSearch=React.createClass({displayName:"WordSearch",getInitialState:function(){return{menuList:[],indicatorActive:!1,buttonRef:null}},componentDidMount:function(){this.setState({buttonRef:React.findDOMNode(this.refs.button)})},handleSearch:function(){this.setState({indicatorActive:!0});var keyword=React.findDOMNode(this.refs.keyword).value,self=this;$.ajax({url:"/menu/",type:"get",data:{keyword:keyword},success:function(data){self.setState({menuList:data})},fail:function(){console.log(arguments)},complete:function(){this.setState({indicatorActive:!1})}.bind(this)})},render:function(){var classes=React.addons.classSet({hidden:!this.props.visible,"word-search":!0,container:!0}),menuList=this.state.menuList.map(function(menu){return React.createElement("tr",{key:menu.id},React.createElement("td",null,menu.id),React.createElement("td",null,menu.name))});return React.createElement("div",{className:classes},React.createElement("fieldset",null,React.createElement("div",{className:"input-group"},React.createElement("input",{type:"text",ref:"keyword",className:"form-control",placeholder:"キーワード"}),React.createElement("span",{className:"input-group-btn"},React.createElement("button",{ref:"button",className:"btn btn-default",type:"button",onClick:this.handleSearch},React.createElement("i",{className:"glyphicon glyphicon-search"})),React.createElement(Indicator,{buttonRef:this.state.buttonRef,active:this.state.indicatorActive})))),React.createElement("table",{className:"table table-striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"ID"),React.createElement("th",null,"メニュー名"))),React.createElement("tbody",null,menuList)))}}),Genre=React.createClass({displayName:"Genre",getInitialState:function(){return{buttonRef:null,indicatorActive:!1}},componentDidMount:function(){this.setState({buttonRef:React.findDOMNode(this.refs.button)})},handleClick:function(){console.log(arguments),this.setState({indicatorActive:!0})},render:function(){var classes=React.addons.classSet({hidden:!this.props.visible,genre:!0,container:!0});return React.createElement("div",{className:classes},React.createElement("fieldset",null,React.createElement("div",{className:"input-group"},React.createElement("input",{type:"text",className:"form-control",placeholder:"ジャンル"}),React.createElement("span",{className:"input-group-btn"},React.createElement("button",{className:"btn btn-default",type:"button",ref:"button",onClick:this.handleClick},"Go!"),React.createElement(Indicator,{buttonRef:this.state.buttonRef,active:this.state.indicatorActive})))))}}),Neighbor=React.createClass({displayName:"Neighbor",render:function(){var classes=React.addons.classSet({hidden:!this.props.visible,neighbor:!0,container:!0});return React.createElement("div",{className:classes})}}),MenuRegistration=React.createClass({displayName:"MenuRegistration",render:function(){var classes=React.addons.classSet({hidden:!this.props.visible,"menu-registration":!0,container:!0});return React.createElement("div",{className:classes})}}),TopBox=React.createClass({displayName:"TopBox",render:function(){var classes=React.addons.classSet({TopBox:!0});return React.createElement("div",{id:"top-box",className:classes},React.createElement("div",{id:"catch-copy"},React.createElement("h2",null,"今日、なに食べる？"),React.createElement("p",null,"ふ〜どふぁいんだ〜がメニューを提案します。"),React.createElement("p",null,"今日もあなたの食事が楽しくなりますように。")),React.createElement("div",{id:"login-box"},React.createElement(LoginBox,null)))}}),GlobalMenu=React.createClass({displayName:"GlobalMenu",getInitialState:function(){return{listVisible:!1,data:[{description:"word-search",text:"ワード検索",icon:"search"},{description:"genre",text:"ジャンル別",icon:"tags"},{description:"neighbor",text:"おとなり",icon:"home"},{description:"settings",text:"設定",icon:"cog"},{description:"login",text:"ログイン",icon:"log-in"}]}},switchListVisible:function(){this.setState({listVisible:!this.state.listVisible})},handleClick:function(e){this.props.onItemClicked(e),this.setState({listVisible:!1})},render:function(){var self=this,items=this.state.data.map(function(data){return React.createElement("li",{key:"global-menu-item_"+data.description,className:"global-menu-item"},React.createElement("a",{href:"#",onClick:self.handleClick.bind(self,{data:data})},React.createElement("i",{className:"glyphicon glyphicon-"+data.icon}),React.createElement("span",{className:"global-menu-text"},data.text)))});return React.createElement("div",{className:"GlobalMenu"},React.createElement("a",{className:"global-menu-button btn btn-default",onClick:this.switchListVisible},React.createElement("i",{className:"glyphicon glyphicon-list"})),React.createElement(TransitionGroup,{transitionName:"global-menu-list"},this.state.listVisible?React.createElement("ul",{key:"global-menu-list",className:"global-menu-list"},items):null,this.state.listVisible?React.createElement("div",{className:"screen-shutter",onClick:this.switchListVisible}):null))}}),Page=React.createClass({displayName:"Page",getInitialState:function(){return{topBoxVisible:!0}},handleGuestMenuActiveChange:function(e){this.setState({topBoxVisible:!e.active})},handleGlobalMenuItemClicked:function(e){"login"===e.data.description&&this.setState({topBoxVisible:!0})},render:function(){return React.createElement("div",null,React.createElement(GlobalMenu,{onItemClicked:this.handleGlobalMenuItemClicked}),React.createElement(TransitionGroup,{transitionName:"top-box"},this.state.topBoxVisible?React.createElement(TopBox,null):null),React.createElement(GuestMenu,{onActiveChange:this.handleGuestMenuActiveChange}))}});React.render(React.createElement(Page,null),document.getElementById("page"))})(jQuery);